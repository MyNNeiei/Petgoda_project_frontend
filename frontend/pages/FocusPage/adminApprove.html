<!DOCTYPE html>
<html lang="en" class="antialiased">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>DataTables </title>
	<meta name="description" content="(Formerly Tailwind Toolbox)">
	<meta name="keywords" content="">

	<!-- Tailwind CSS -->
	<link href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

	<!-- DataTables CSS -->
	<link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
	<link href="https://cdn.datatables.net/responsive/2.4.1/css/responsive.dataTables.min.css" rel="stylesheet">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Sniglet:wght@400;800&display=swap" rel="stylesheet">

	<style>
		/* Background Blur */
		body {
			position: relative;
			overflow: hidden;
			font-family: "Sniglet", serif;
			font-size: medium;
		}

		body::before {
			content: "";
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: url("3.jpg") center/cover no-repeat;
			filter: blur(20px);
			z-index: -1;
		}

		/* Form fields */
		.dataTables_wrapper select,
		.dataTables_wrapper .dataTables_filter input {
			color: #4a5568;
			padding: 0.5rem 1rem;
			line-height: 1.25;
			border-width: 2px;
			border-radius: 0.25rem;
			border-color: #edf2f7;
			background-color: #edf2f7;
		}

		/* Row Hover */
		table.dataTable.hover tbody tr:hover {
			background-color: #ebf4ff;
		}

		/* Pagination Buttons */
		.dataTables_wrapper .dataTables_paginate .paginate_button {
			font-weight: 700;
			border-radius: 0.25rem;
			border: 1px solid transparent;
		}

		.dataTables_wrapper .dataTables_paginate .paginate_button.current {
			color: #fff !important;
			font-weight: 700;
			border-radius: 0.25rem;
			background: #667eea !important;
			border: 1px solid transparent;
		}

		.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
			color: #fff !important;
			font-weight: 700;
			border-radius: 0.25rem;
			background: #667eea !important;
			border: 1px solid transparent;
		}

		/* Ensure search bar is visible */
		.dataTables_filter {
			display: block !important;
		}

		.maintopic {
			font-size: xx-large;
			text-align: center;
			margin-bottom: 2%;
		}

		/* ทำให้ข้อความทุกส่วนในตารางเป็นปกติ */
		table.dataTable thead th,
		table.dataTable tbody td,
		.dataTables_wrapper .dataTables_paginate .paginate_button {
			font-weight: normal !important;
		}

		/* ทำให้ปุ่มใน actions ไม่หนา */
		.actions button {
			font-weight: normal !important;
		}
	</style>
</head>

<body class="bg-gray-100 text-gray-900 tracking-wider leading-normal">

	<!-- Container -->
	<div class="container w-full md:w-4/5 xl:w-4/5 mx-auto px-2" style="margin-top: 7%;">

		<!-- Card -->
		<div id="recipients" class="p-8 mt-6 lg:mt-0 rounded shadow bg-white">
			<h1 class="maintopic"> Admin Approve Hotels </h1>
			<table id="example" class="stripe hover" style="width:100%; padding-top: 1em; padding-bottom: 1em;">
				<thead>
					<tr>
						<th>ID</th>
						<th>Hotel Name</th>
						<th>Submitted By</th>
						<th>Status</th>
						<th>Reviewed At</th>
						<th>Approved At</th>
						<th>Reason</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					<tr data-id="1" data-status="Pending">
						<td>1</td>
						<td>Hotel California</td>
						<td>Tiger Nixon</td>
						<td class="status">Pending</td>
						<td>2024-02-01</td>
						<td>-</td>
						<td>Awaiting approval</td>
						<td class="actions">
							<button class="approve px-2 py-1 bg-green-500 text-white rounded">Approve</button>
							<button class="reject px-2 py-1 bg-red-500 text-white rounded">Reject</button>
						</td>
					</tr>
					<tr data-id="2" data-status="Approved">
						<td>2</td>
						<td>Grand Palace</td>
						<td>Donna Snider</td>
						<td class="status">Approved</td>
						<td>2024-01-15</td>
						<td>2024-01-20</td>
						<td>-</td>
						<td class="actions">
							<button class="cancel px-2 py-1 bg-yellow-500 text-white rounded">Cancel Approval</button>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- /Card -->

	</div>
	<!-- /Container -->
	 

	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<!-- DataTables JS -->
	<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/responsive/2.4.1/js/dataTables.responsive.min.js"></script>

	<script>
		$(document).ready(function () {
			$('#example').DataTable({ responsive: true });

			$(".approve, .reject").click(function () {
				let row = $(this).closest("tr");
				let hotelId = row.data("id");
				let action = $(this).hasClass("approve") ? "Approved" : "Rejected";

				$.ajax({
					url: "/update-hotel-status/",
					method: "POST",
					data: {
						id: hotelId,
						status: action,
						csrfmiddlewaretoken: "{{ csrf_token }}"
					},
					success: function (response) {
						row.find(".status").text(action);
						if (action === "Approved") {
							row.find(".actions").html('<button class="cancel px-2 py-1 bg-yellow-500 text-white rounded">Cancel Approval</button>');
						} else {
							row.find(".actions").html('<span class="text-red-500">Rejected</span>');
						}
					}
				});
			});

			$(document).on("click", ".cancel", function () {
				let row = $(this).closest("tr");
				let hotelId = row.data("id");

				$.ajax({
					url: "/update-hotel-status/",
					method: "POST",
					data: {
						id: hotelId,
						status: "Pending",
						csrfmiddlewaretoken: "{{ csrf_token }}"
					},
					success: function (response) {
						row.find(".status").text("Pending");
						row.find(".actions").html(`
							<button class="approve px-2 py-1 bg-green-500 text-white rounded">Approve</button>
							<button class="reject px-2 py-1 bg-red-500 text-white rounded">Reject</button>
						`);
					}
				});
			});
		});
	</script>

</body>

</html>